<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>EyeMind – Advanced Prototype</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700" rel="stylesheet"/>
  <!-- heatmap.js -->
  <script src="https://cdn.jsdelivr.net/npm/heatmapjs@2.0.5/heatmap.min.js"></script>
  <!-- jsPDF for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- Custom Styles -->
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <div class="container py-4">
    <h1 class="text-center mb-4">EyeMind – Hybrid Loneliness Intervention</h1>
    <!-- Nav Tabs -->
    <ul class="nav nav-tabs" id="mainNav" role="tablist">
      <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#intro">Introduction</button></li>
      <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#instructions">Instructions</button></li>
      <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#login">Login</button></li>
      <li class="nav-item"><button class="nav-link disabled" data-bs-toggle="tab" data-bs-target="#ai">AI Risk</button></li>
      <li class="nav-item"><button class="nav-link disabled" data-bs-toggle="tab" data-bs-target="#gaze">Gaze Engagement</button></li>
      <li class="nav-item"><button class="nav-link disabled" data-bs-toggle="tab" data-bs-target="#dce">DCE</button></li>
      <li class="nav-item"><button class="nav-link disabled" data-bs-toggle="tab" data-bs-target="#recs">Recommendations</button></li>
      <li class="nav-item"><button class="nav-link disabled" data-bs-toggle="tab" data-bs-target="#summary">Summary</button></li>
    </ul>

    <div class="tab-content mt-3">
      <!-- Introduction -->
      <div class="tab-pane fade show active" id="intro">
        <p>This app demonstrates EyeMind: combining AI risk scoring, advanced gaze analytics, preference elicitation (DCE), audio journalling, calendar reminders, PDF sharing and gamified badges to combat loneliness in older adults.</p>
      </div>

      <!-- Instructions -->
      <div class="tab-pane fade" id="instructions">
        <ol>
          <li>Go to <strong>Login</strong> and sign in with <code>testuser / welcome123</code>.</li>
          <li>Complete the <strong>AI Risk</strong> questionnaire.</li>
          <li>Calibrate and explore <strong>Gaze Engagement</strong>.</li>
          <li>Answer scenarios in <strong>DCE</strong>.</li>
          <li>Record a short <strong>Audio Journal</strong> entry.</li>
          <li>Set a social <strong>Reminder</strong> in the calendar.</li>
          <li>View your <strong>Recommendations</strong> and earn <strong>Badges</strong>.</li>
          <li>Review or share the <strong>Summary</strong> as PDF.</li>
        </ol>
      </div>

      <!-- Login -->
      <div class="tab-pane fade" id="login">
        <form id="loginForm" class="col-md-6 mx-auto">
          <div class="mb-3">
            <label class="form-label">Username</label>
            <input id="username" class="form-control" placeholder="testuser"/>
          </div>
          <div class="mb-3">
            <label class="form-label">Password</label>
            <input id="password" type="password" class="form-control" placeholder="welcome123"/>
          </div>
          <button id="loginBtn" type="button" class="btn btn-primary">Login</button>
          <p id="loginMsg" class="mt-2"></p>
        </form>
      </div>

      <!-- AI Risk -->
      <div class="tab-pane fade" id="ai">
        <h4>Loneliness Risk Assessment</h4>
        <div class="mb-3">
          <label>How often feel left out?</label><br/>
          <select id="q1" class="form-select w-auto d-inline-block">
            <option value="0">Never</option>
            <option value="1">Sometimes</option>
            <option value="2">Often</option>
          </select>
        </div>
        <div class="mb-3">
          <label>How often lack companionship?</label><br/>
          <select id="q2" class="form-select w-auto d-inline-block">
            <option value="0">Never</option>
            <option value="1">Sometimes</option>
            <option value="2">Often</option>
          </select>
        </div>
        <button id="calcScoreBtn" class="btn btn-primary">Calculate Risk</button>
        <p id="riskResult" class="mt-3"></p>
      </div>

      <!-- Gaze Engagement -->
      <div class="tab-pane fade" id="gaze">
        <h4>Gaze Engagement & Calibration</h4>
        <p id="calMsg">Click <strong>Calibrate</strong> to begin.</p>
        <button id="startCal" class="btn btn-secondary mb-2">Calibrate</button>
        <div id="calArea" class="position-relative border mb-2" style="height:300px;background:#fff;">
          <!-- calibration dots inserted here -->
        </div>
        <div id="gazeControls" class="d-none">
          <button id="startGaze" class="btn btn-success me-2">Start Tracking</button>
          <button id="stopGaze" class="btn btn-danger me-2" disabled>Stop</button>
          <button id="toggleHeatmap" class="btn btn-secondary">Show Heatmap</button>
        </div>
        <div class="row mt-3">
          <div class="col-md-6">
            <canvas id="scanCanvas" class="border"></canvas>
          </div>
          <div class="col-md-6">
            <div id="gazeStats" class="p-2 border bg-light"></div>
          </div>
        </div>
      </div>

      <!-- DCE Preferences -->
      <div class="tab-pane fade" id="dce">
        <h4>Discrete Choice Experiment</h4>
        <!-- scenarios as before... -->
        <!-- omitted for brevity (same structure as prior code) -->
      </div>

      <!-- Recommendations -->
      <div class="tab-pane fade" id="recs">
        <h4>Personalized Recommendations</h4>
        <div id="recommendations"></div>
        <h5 class="mt-4">Badges Earned</h5>
        <div id="badges" class="mb-4"></div>
        <h5>Set a Reminder</h5>
        <input type="datetime-local" id="reminderTime" class="form-control w-auto d-inline-block"/>
        <button id="setReminder" class="btn btn-info ms-2">Add</button>
        <ul id="reminderList" class="mt-2"></ul>
      </div>

      <!-- Summary -->
      <div class="tab-pane fade" id="summary">
        <h4>Summary Report</h4>
        <div id="summaryContent"></div>
        <button id="generatePDF" class="btn btn-outline-primary mt-3">Share as PDF</button>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS & Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Custom JS -->
  <script src="app.js"></script>
</body>
</html>
